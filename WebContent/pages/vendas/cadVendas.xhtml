<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core">
<ui:composition template="/pages/templates/padrao.xhtml">
	<ui:define name="corpo">
		<br />
		<h:form id="frmCadastroUsuario" acceptcharset="ISO-8859-1">
			<p:dialog widgetVar="statusDialog" modal="true" draggable="false"
				closable="false" resizable="false" showHeader="false">
				<p:outputLabel value="Aguarde.."
					style="font-family: 'Pacifico',cursive;" />
				<br />
				<img src="../../resources/img/ajax-carregando.gif" />
			</p:dialog>
			<h4>Cadastro de Vendas</h4>
			<hr />
			<p:growl id="growl" showDetail="true" sticky="false" life="3000" />

			<br />
			<h6>Dados do Aluno</h6>
			<hr />

			<div class="form-row">
				<div class="form-group col-md-3">
					<label for="inputCpf">CPF</label>
					<h:panelGrid columns="2" style="width:100%;">
						<p:inputMask mask="999.999.999-99" value="#{cadVendasMB.cpfAluno}"
							style="border:0px;font-size:14px;" class="form-control" id="cpf" />
						<p:commandLink id="btnalunos" value="Buscar"
							action="#{cadVendasMB.buscarAluno()}" styleClass="btn btn-dark"
							update="infAluno, infEnderecoAluno, panelCep">
						</p:commandLink>
					</h:panelGrid>
				</div>
			</div>

			<h:panelGroup id="infAluno" style="width:100%;">
				<div class="form-row">
					<div class="form-group col-md-6">
						<label for="inputNome">Nome</label>
						<h:inputText value="#{cadVendasMB.alunos.nome}"
							class="form-control" id="inputNome" placeholder="Nome" />
					</div>
					<div class="form-group col-md-4">
						<label for="inputRG">Email</label>
						<h:inputText value="#{cadVendasMB.alunos.email}"
							class="form-control" id="inputRG" placeholder="RG" />
					</div>
					<div class="form-group col-md-2">
						<label for="dataNasc">Telefone Celular</label>
						<h:inputText class="form-control" id="dataNasc"
							value="#{cadVendasMB.alunos.telefonecelular}">
						</h:inputText>
					</div>
				</div>
			</h:panelGroup>
			<br />
			<br />
			<h6>Endereço</h6>
			<hr />

			<h:panelGroup id="panelCep">
				<div class="form-row">
					<div class="form-group col-md-3">
						<label for="inputCEP">CEP</label>

						<h:panelGrid columns="2" style="width:100%;">
							<h:inputText value="#{cadVendasMB.cep}" class="form-control"
								id="inputCEP" placeholder="CEP" />
							<p:commandLink id="btnConfirmar" value="Buscar"
								action="#{cadVendasMB.buscarendereco()}"
								styleClass="btn btn-dark" update="infEnderecoAluno">
							</p:commandLink>
						</h:panelGrid>
					</div>
				</div>
			</h:panelGroup>
			<h:panelGroup id="infEnderecoAluno">
				<div class="form-row">
					<div class="form-group col-md-3">
						<label for="inputTipoLogradouro">Tipo Logradouro</label>
						<h:inputText value="#{cadVendasMB.alunos.tipologradouro}"
							class="form-control" id="inputTipoLogradouro"
							placeholder="Tipo Logradouro" />
					</div>
					<div class="form-group col-md-3">
						<label for="inputlogradouro">Logradouro</label>
						<h:inputText value="#{cadVendasMB.alunos.logradouro}"
							class="form-control" id="inputlogradouro"
							placeholder="Logradouro" />
					</div>
					<div class="form-group col-md-3">
						<label for="inputNumero">Número</label>
						<h:inputText value="#{cadVendasMB.alunos.numero}"
							class="form-control" id="inputNumero" placeholder="Número" />
					</div>
					<div class="form-group col-md-3">
						<label for="inputComplemento">Complemento</label>
						<h:inputText value="#{cadVendasMB.alunos.complemento}"
							class="form-control" id="inputComplemento" placeholder="CEP" />
					</div>
				</div>

				<div class="form-row">
					<div class="form-group col-md-3">
						<label for="inputBairro">Bairro</label>
						<h:inputText value="#{cadVendasMB.alunos.bairro}"
							class="form-control" id="inputBairro" placeholder="Bairro" />
					</div>
					<div class="form-group col-md-3">
						<label for="inputCidade">Cidade</label>
						<h:inputText value="#{cadVendasMB.alunos.cidade}"
							class="form-control" id="inputCidade" placeholder="Cidade" />
					</div>
					<div class="form-group col-md-3">
						<label for="inputUfEstado">UF - Estado</label>
						<h:inputText value="#{cadVendasMB.alunos.estado}"
							class="form-control" id="inputUfEstado" placeholder="UF Estado" />
					</div>
				</div>
			</h:panelGroup>
			<br />
			<br />
			<h6>Produtos</h6>
			<hr />
			<div class="form-row">
				<div class="form-group col-md-9">
					<label>Produtos*</label>
					<h:panelGrid columns="2" style="width:100%;">
						<h:selectOneMenu id="exampleProdutos" style="width: 100%;"
							immediate="true" value="#{cadVendasMB.servicos}"
							converter="ServicosConverter" styleClass="form-control">
							<f:selectItem itemLabel="Selecione" itemValue="0"
								noSelectionOption="true" />
							<f:selectItems value="#{cadVendasMB.listaServicos}"
								var="servicosSelecionado"
								itemLabel="#{servicosSelecionado.nomeservicos}"
								itemValue="#{servicosSelecionado}" />
							<f:attribute name="listaServicos"
								value="#{cadVendasMB.listaServicos}" />
						</h:selectOneMenu>
						<p:commandLink id="btnAdicionar" value="Adicionar"
							action="#{cadVendasMB.dadosProdutos()}" style="margin-left:2%;"
							update="infProdutos, valorServico, idTabelaPagamentos, panelValorRestante"
							styleClass="btn btn-dark">
						</p:commandLink>
					</h:panelGrid>
				</div>
				<div class="form-group col-md-3">
					<label>Valor R$</label>
					<h:inputText value="#{cadVendasMB.valorServico}" id="valorServico"
						class="form-control" style="text-align:right;">
						<f:convertNumber pattern="##,###,###,###.##" minFractionDigits="2" />
					</h:inputText>
				</div>
			</div>
			<h:panelGroup id="infProdutos">
				<div class="form-row">
					<div class="form-group col-md-3">
						<label>Carga Horária</label>
						<h:inputText value="#{cadVendasMB.cargahoraria}"
							id="cargaHorariaServico" class="form-control" />
					</div>
					<div class="form-group col-md-6">
						<label>Professor</label>
						<h:selectOneMenu id="exampleProfessores" style="width: 100%;"
							immediate="true" value="#{cadVendasMB.professores}"
							converter="ProfessoresConverter" styleClass="form-control">
							<f:selectItem itemLabel="Selecione" itemValue="0"
								noSelectionOption="true" />
							<f:selectItems value="#{cadVendasMB.listaProfessores}"
								var="professoresSelecionado"
								itemLabel="#{professoresSelecionado.nome}"
								itemValue="#{professoresSelecionado}" />
							<f:attribute name="listaProfessores"
								value="#{cadVendasMB.listaProfessores}" />
						</h:selectOneMenu>
					</div>
				</div>
			</h:panelGroup>
			<br />

			<h6>Listagem do Orçamento</h6>
			<hr />
			<h:panelGroup id="panelAdicionarPagamento">
				<div class="form-row">

					<div class="form-group col-md-6">
						<label>Descrição</label>
						<h:inputText value="#{cadVendasMB.descricaoFormaPagamento}"
							id="agencia" class="form-control" />
					</div>
					<div class="form-group col-md-3">
						<label>Valor R$</label>
						<h:inputText value="#{cadVendasMB.valorFormaPagamento}"
							id="valorOrcamento" class="form-control" style="text-align:right;">
							<f:convertNumber pattern="##,###,###,###.##"
								minFractionDigits="2" />
						</h:inputText>
					</div>
					<div class="form-group col-md-3">
						<label>-</label> <br />
						<p:commandLink styleClass="btn btn-dark"
							update="panelPagamentos, panelValorRestante, panelAdicionarPagamento"
							value="Adicionar"
							action="#{cadVendasMB.adicionarFormaPagamento()}" />
					</div>
				</div>
			</h:panelGroup>
			<h:panelGroup id="panelPagamentos">
				<div class="form-row">
					<p:dataTable id="idTabelaPagamentos" var="formapagamento"
						value="#{cadVendasMB.listaFormasPagamento}" style="border:none;"
						class="tabelacontas" scrollRows="10" scrollable="true"
						scrollHeight="200" rowIndexVar="rowIx">

						<p:column headerText="Descrição"
							sortBy="#{formapagamento.descricao}"
							style="text-align:left; font-size:12px; background:white; color:black; border:#fff;">
							<h:outputText value="#{formapagamento.descricao}" />

						</p:column>
						<p:column headerText="Valor" sortBy="#{formapagamento.valor}"
							style="width:15%; font-size:12px; background:white; color:black; border:none;text-align:right;">
							<h:outputText value="#{formapagamento.valor}">
								<f:convertNumber pattern="##,###,###,###.##"
									minFractionDigits="2" />
							</h:outputText>
						</p:column>
						<p:column headerText=""
							style="width:10%; text-align:left; font-size:12px; background:white; color:black; border:#fff;">
							<p:commandLink
								action="#{cadVendasMB.excluirFormaPagamento(rowIx)}"
								style="text-align: left;color:black;"
								update=":frmCadastroUsuario:panelPagamentos, :frmCadastroUsuario:panelValorRestante">
								<img src="../../resources/img/excluir.svg" style="width: 18%;" />
							</p:commandLink>
						</p:column>
					</p:dataTable>
				</div>
			</h:panelGroup>
			<br />
			<h6>Formas de Pagamento</h6>
			<hr />

			<div class="form-row">
				<div class="form-group col-md-3">
					<label>Tipo de Pagamento</label>
					<h:selectOneMenu id="tipodocumento"
						value="#{cadVendasMB.contasreceber.formapagamento}"
						styleClass="form-control">
						<f:selectItem itemLabel="Boleto" itemValue="Boleto" />
						<f:selectItem itemLabel="Cartão Crédito"
							itemValue="Cartão Crédito" />
					</h:selectOneMenu>
				</div>
				<div class="form-group col-md-3">
					<label>Data Vencimento</label>
					<p:inputMask mask="99/99/9999"
						value="#{cadVendasMB.contasreceber.datavencimento}"
						style="border:0px;font-size:14px;" class="form-control"
						id="dataVencimentoPagamento">
						<f:convertDateTime pattern="dd/MM/yyyy"
							timeZone="America/Sao_Paulo" />
					</p:inputMask>
				</div>
			</div>
			<h:panelGroup id="panelCalculoPagamento">
				<div class="form-row">
					<div class="form-group col-md-3">
						<label>Valor a Parcelar R$</label>
						<h:inputText value="#{cadVendasMB.valorParcelar}"
							style="text-align:right;" id="valorParcelarPagamento"
							class="form-control">
							<f:convertNumber pattern="##,###,###,###.##"
								minFractionDigits="2" />
							<p:ajax event="change"
								listener="#{cadVendasMB.calcularParcelas()}"
								update="panelCalculoPagamento, panelValorRestante" />
						</h:inputText>
					</div>
					<div class="form-group col-md-3">
						<label>Número Parcelas</label>
						<h:inputText value="#{cadVendasMB.contasreceber.nparcela}"
							id="numeroParcelasPagamento" class="form-control">
							<p:ajax event="change"
								listener="#{cadVendasMB.calcularParcelas()}"
								update="panelCalculoPagamento, panelValorRestante" />
						</h:inputText>
					</div>
					<div class="form-group col-md-3">
						<label>Valor da Parcela R$</label>
						<h:inputText value="#{cadVendasMB.contasreceber.valorparcela}"
							id="valorParcelaPagamento" class="form-control"
							readonly="true" style="text-align:right;">
							<f:convertNumber pattern="##,###,###,###.##"
								minFractionDigits="2" />
						</h:inputText>
					</div>
					<div class="form-group col-md-3">
						<label>-</label> <br />
						<p:commandLink styleClass="btn btn-dark"
							update="panelValorRestante, panelTabelaContas, panelCalculoPagamento"
							value="Adicionar" action="#{cadVendasMB.adicionarContas()}" />
					</div>
				</div>
			</h:panelGroup>
			<h:panelGroup id="panelValorRestante">
				<div class="form-row">
					<div class="form-group col-md-3">
						<label>Valor Restante R$</label>
						<h:inputText value="#{cadVendasMB.valorRestante}" readonly="true"
							id="valorRestantePagamento" class="form-control"
							placeholder="Digito da agência"
							style="text-align:right;color:red;">
							<f:convertNumber pattern="##,###,###,###.##"
								minFractionDigits="2" />
						</h:inputText>
					</div>
					<div class="form-group col-md-3">
						<label>VALOR TOTAL R$</label>
						<h:inputText value="#{cadVendasMB.vendas.valorvenda}"
							readonly="true" id="valorTotalVenda" class="form-control"
							placeholder="Digito da agência"
							style="text-align:right;color:blue;">
							<f:convertNumber pattern="##,###,###,###.##"
								minFractionDigits="2" />
						</h:inputText>
					</div>
				</div>
			</h:panelGroup>
			<h:panelGroup id="panelTabelaContas">
				<div class="form-row">
					<p:dataTable id="idTabelaContas" var="contas"
						value="#{cadVendasMB.listaContasReceber}" style="border:none;"
						class="tabelacontas" scrollRows="10" scrollable="true"
						scrollHeight="200" rowIndexVar="rowIx">

						<p:column headerText="Parcela" sortBy="#{contas.numeroparcela}"
							style="width:32%; font-size:12px; background:white; color:black; border:none;text-align:left;">
							<h:outputText value="#{contas.numeroparcela}" />
						</p:column>
						<p:column headerText="Data Vencimento"
							sortBy="#{contas.datavencimento}"
							style="width:25%; text-align:left; font-size:12px; background:white; color:black; border:#fff;">
							<h:outputText value="#{contas.datavencimento}">
								<f:convertDateTime pattern="dd/MM/yyyy"
									timeZone="America/Sao_Paulo" />
							</h:outputText>
						</p:column>
						<p:column headerText="Pagamento" sortBy="#{contas.formapagamento}"
							style="width:32%; font-size:12px; background:white; color:black; border:none;text-align:left;">
							<h:outputText value="#{contas.formapagamento}" />
						</p:column>
						<p:column headerText="Valor" sortBy="#{contas.valorparcela}"
							style="width:32%; font-size:12px; background:white; color:black; border:none;text-align:left;">
							<h:outputText value="#{contas.valorparcela}">
								<f:convertNumber pattern="##,###,###,###.##"
									minFractionDigits="2" />
							</h:outputText>
						</p:column>
						<p:column headerText=""
							style="width:8%; text-align:left; font-size:12px; background:white; color:black; border:#fff;">
							<p:commandLink action="#{cadVendasMB.excluirContas(rowIx)}"
								style="text-align: left;color:black;"
								update=":frmCadastroUsuario:panelTabelaContas, :frmCadastroUsuario:panelValorRestante">
								<img src="../../resources/img/excluir.svg" style="width: 30%;" />
							</p:commandLink>
						</p:column>
					</p:dataTable>
				</div>
			</h:panelGroup>
			<br />
			<br />

			<div class="form-row">
				<div class="form-group col-md-12">
					<label>Observações</label>
					<h:inputTextarea value="#{cadVendasMB.vendas.observacao}"
						id="parcelasrestantes" class="form-control"
						placeholder="Parcelas Restantes" rows="5">
					</h:inputTextarea>
				</div>
			</div>


			<br />
			<hr />
			<div align="center">
				<p:commandLink styleClass="btn btn-dark" value="Salvar"
					action="#{cadVendasMB.salvar()}" update="growl" />
				<p:commandLink ajax="false" styleClass="btn btn-danger"
					style="margin-left:2%;" value="Cancelar"
					action="#{cadVendasMB.cancelar()}" />
			</div>
			<br />
			<br />
		</h:form>
	</ui:define>
</ui:composition>
</html>